{namespace v=FluidTYPO3\Vhs\ViewHelpers}

{v:iterator.explode(content: '{data.tx_mask_product_selector}', glue: ',') -> f:variable(name: 'selectedProductsArray')}

<div class="product-link {f:if(condition: '{data.tx_mask_small_checkbox} == 1', then: 'small', else: 'large')} {f:if(condition: '{data.tx_mask_active_slider} == 1', then: 'slider', else: 'no-slider')}"
>
	
	<f:if condition="{data.header}">
		<div class="upper-header-wrapper">
			<h2 class="upper-header">
				{data.header}
			</h2>
		</div>
	</f:if>

	<div class="product-list-wrapper">
		<f:for each="{products}" as="product">
			<f:for each="{selectedProductsArray}" as="selectedProduct">
				<f:if condition="{product.data.uid} == {selectedProduct}">
					<div class="product">
						<f:if condition="{data.tx_mask_small_checkbox} == 0">
							<f:then>
								<f:render partial="Product_large.html" arguments="{product: product}"/>
							</f:then>
							<f:else>
								<f:render partial="Product_small.html" arguments="{product: product}"/>
							</f:else>
						</f:if>
					</div>		
				</f:if>
			</f:for>
		</f:for>
	</div>

	<div class="underline-wrapper">
		<div class="underline"></div>
	</div>

</div>



